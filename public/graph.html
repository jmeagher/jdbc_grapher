<html>
  <head>
    <title>Super fancy graphing</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  </head>
  <body>
    <div id="sql_form">
      Sql goes here:<textarea id="sql">select purchase_day, sum(revenue_at_offer_end_usd) revenue, count(*) purchases
      from watson_bisum_purchases
      where purchase_day >= '2013-11-01'
      group by purchase_day
      order by purchase_day limit 1000
  </textarea>
  <input type="text" id="chartType" value='AreaChart'/>
  <input type="text" id="options" value='{name:"test" , width:"100%", height : "100%"}'/>
      <button onclick="graphit()" >Graph it</button>
    </div>

    <input type="text" id="graphUrl" value='Graph url will go here'/>
    <div id="graph" width="100%" height="500" >Graph will go here, be patient<div>
  </body>

  <script type="text/javascript">

  function graphit() {
    var params = {
           sql: $("#sql").val(),
           options: $("#options").val(),
           chartType: $("#chartType").val()
    };
    var paramString = $.param(params).replace(/'/g, "%27");
    console.log(paramString);
    var url = "just_the_graph.html?" + paramString;
    $("#graphUrl").val(url);
    $("#graph").html("<iframe width='100%' height='100%' src='" + url + "'></iframe>");
  }
  </script>
</html>


